<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hero Mom - 프로토타입</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="game-container">
        <!-- 1. Top Status Bar -->
        <header class="status-bar">
            <div class="status-header">
                <h2>아들 상태 <span id="son-level" style="font-weight: 500; color: #64748b; font-size: 0.9rem;">(Lv. 1)</span>
                    <span id="son-weapon" class="weapon-badge tier-C">몽둥이 (공+1)</span>
                </h2>
                <div class="parent-resources">
                    <div class="resource" style="color:#eab308">🪙 <span id="res-gold">1500</span></div>
                </div>
            </div>
            
            <!-- Affinity Stats (New) -->
            <div class="affinity-stats">
                <div class="affinity-badge" title="신뢰도: 전투 지능 상승">🛡️ <span id="aff-trust">50</span></div>
                <div class="affinity-badge" title="애정도: 집에서 회복량 상승">❤️ <span id="aff-affection">50</span></div>
                <div class="affinity-badge" title="반항심: 훈련 거부 및 가출 확률" style="color:#ef4444;">⚡ <span id="aff-rebellion">0</span></div>
            </div>

            <div class="bars">
                <div class="bar-container"><div class="label">HP</div><div class="bar-bg"><div class="bar hp" id="bar-hp" style="width: 100%;"></div></div></div>
                <div class="bar-container"><div class="label">허기</div><div class="bar-bg"><div class="bar hunger" id="bar-hunger" style="width: 100%;"></div></div></div>
                <div class="bar-container"><div class="label">EXP</div><div class="bar-bg"><div class="bar exp" id="bar-exp" style="width: 0%;"></div></div></div>
            </div>
            
            <!-- Quest Alert Banner (Hidden by default) -->
            <div id="quest-alert" class="quest-alert" onclick="openQuestModal()" style="display: none;">
                ❗ 아들의 부탁이 있습니다! (남은 시간: <span id="quest-timer">30</span>초)
            </div>
        </header>

        <!-- 2. Room Navigation Tabs -->
        <nav class="room-tabs">
            <button class="room-tab active" data-room="room-bed">🛏️ 침실 <span class="son-indicator">👦🏻</span></button>
            <button class="room-tab" data-room="room-desk">📚 서재 <span class="son-indicator">👦🏻</span></button>
            <button class="room-tab" data-room="room-table">🍽️ 주방 <span class="son-indicator">👦🏻</span></button>
            <button class="room-tab" data-room="room-dummy">🤺 훈련장 <span class="son-indicator">👦🏻</span></button>
        </nav>

        <!-- 3. Main Stage (Active Room) -->
        <main class="house-view-container">
            <div class="room-view active" id="view-room-bed">
        <div class="furniture bed">🛏️<div class="furn-level">(Lv.<span id="lvl-bed">1</span>)</div></div>
        <div class="interact-slot" id="slot-wardrobe" onclick="openInventory('weapon')" style="position: absolute; right: 15%; top: 20%;">
            <span class="slot-label">옷장 (무기)</span>➕
        </div>
    </div>
            <div class="room-view" id="view-room-desk"><div class="furniture desk">📚<div class="furn-level">(Lv.<span id="lvl-desk">1</span>)</div><div class="interact-slot" id="slot-study" onclick="openInventory('study')"><span class="slot-label">책꽂이 빈칸</span>➕</div></div></div>
            <div class="room-view" id="view-room-table"><div class="furniture table">🍽️<div class="furn-level">(Lv.<span id="lvl-table">1</span>)</div><div class="interact-slot" id="slot-kitchen" onclick="openInventory('kitchen')"><span class="slot-label">식탁 위 빈접시</span>➕</div></div></div>
            <div class="room-view" id="view-room-dummy"><div class="furniture dummy">🤺<div class="furn-level">(Lv.<span id="lvl-dummy">1</span>)</div><div class="interact-slot" id="slot-training" onclick="openInventory('training')"><span class="slot-label">훈련 도구 슬롯</span>➕</div></div></div>
            
            <!-- Son Sprite -->
            <div class="character son" id="son-sprite">👦🏻<div class="speech-bubble" id="son-speech">뭐 할 거 없나...</div></div>
        </main>

        <!-- 4. Bottom Control Panel -->
        <section class="control-panel">
            <nav class="sys-tabs">
                <button class="sys-tab active" data-sys="sys-work">🪡 부업</button>
                <button class="sys-tab" data-sys="sys-shop">🛒 상점</button>
                <button class="sys-tab" data-sys="sys-smith">🔨 대장간</button>
                <button class="sys-tab" data-sys="sys-mail">✉️ 모험</button>
            </nav>
            <div class="sys-content active" id="sys-work">
                <h3 style="margin-bottom:5px;">집안일 (부업)</h3>
                <p style="font-size:0.85rem; margin-bottom:10px;">아들 몰래 인형 눈알을 붙여 용돈을 법니다.</p>
                <button class="action-btn" id="btn-work" style="background:#64748b; padding:20px; font-size:1.2rem;">🪡 바느질 하기 (+10 골드)</button>
            </div>
            <div class="sys-content" id="sys-shop">
                <h3 style="margin-bottom:5px;">상점 (아이템 구매)</h3>
                <p style="font-size:0.85rem; margin-bottom:10px;">방에 배치할 아이템을 미리 구매해두세요.</p>
                <div style="display:grid; grid-template-columns: 1fr; gap:10px;">
                    <button class="action-btn" style="background:#10b981; margin-top:0;" onclick="buyItem('steak', 100)">🥩 최고급 스테이크 (100G) - 허기폭발</button>
                    <button class="action-btn" style="background:#8b5cf6; margin-top:0;" onclick="buyItem('book_hero', 150)">📘 영웅학 개론 (150G) - 경험치폭발</button>
                    <button class="action-btn" style="background:#f59e0b; margin-top:0;" onclick="buyItem('sandbag', 200)">🏋️ 모래주머니 (200G) - 훈련효율업</button>
                </div>
            </div>
            <div class="sys-content" id="sys-smith">
        <h3>대장간 (장비 가챠 & 합성)</h3>
        <p style="font-size:0.85rem; margin-bottom:10px;">가챠로 뽑은 무기는 인벤토리에 보관되며, 같은 등급 3개를 모아 상위 등급으로 합성할 수 있습니다.</p>
        <button class="action-btn" id="btn-gacha" style="background-color: #0f172a; margin-top:0;">🗡️ 무기 뽑기 (1,000G)</button>
        <div id="gacha-result" class="gacha-result" style="margin-bottom: 15px;"></div>
        
        <div id="synthesis-ui" style="background: #f8fafc; border: 1px solid #e2e8f0; border-radius: 12px; padding: 10px; margin-top:15px;">
            <h4 style="font-size:0.9rem; color:#475569; margin-bottom:8px;">무기 인벤토리 & 합성</h4>
            <div id="weapon-inventory-list" style="display:flex; flex-direction:column; gap:5px;">
                <!-- Filled dynamically by JS -->
            </div>
        </div>
    </div>
            <div class="sys-content" id="sys-mail">
                <h3>우편함 & 마을 소문</h3>
                <ul class="mail-list" style="list-style:none;">
                    <li class="mail-item" style="padding:10px; background:#f8fafc; border:1px solid #e2e8f0; border-radius:8px;">📮 아직 도착한 편지가 없습니다.</li>
                </ul>
            </div>
        </section>

        <!-- Inventory Modal -->
        <div class="modal-overlay" id="inv-modal">
            <div class="modal-content">
                <h3>인벤토리</h3>
                <p style="font-size:0.85rem; margin-bottom:15px;">이 방에 배치할 아이템을 선택하세요.</p>
                <div id="inv-list"></div>
                <button class="action-btn" style="background:#ef4444; margin-top:15px;" onclick="closeInventory()">닫기</button>
            </div>
        </div>

        <!-- Quest Modal -->
        <div class="modal-overlay" id="quest-modal">
            <div class="modal-content">
                <h3 style="color:#eab308;">❗ 아들의 부탁 ❗</h3>
                <p id="quest-desc" style="font-size:0.95rem; margin:15px 0; font-weight:bold; color:#1e293b;">"엄마, 용돈 100골드만 주세요!"</p>
                <p style="font-size:0.8rem; color:#ef4444; margin-bottom:15px;">남은 시간: <span id="quest-modal-timer">30</span>초</p>
                
                <div id="quest-actions" style="display:flex; flex-direction:column; gap:10px;">
                    <button class="action-btn" style="background:#3b82f6; margin-top:0;" id="btn-quest-accept">들어주기</button>
                    <button class="action-btn" style="background:#94a3b8; margin-top:0;" onclick="rejectQuest()">거절하기 (반항심 증가)</button>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
